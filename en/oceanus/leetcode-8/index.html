<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" />
    
    <link rel="stylesheet" href="https://quinoa42.github.io/style/site.min.css">
    <title>
  LeetCode 8: String to Integer (atoi) &ndash; Emain Ablach
</title>
  </head>
  <body>
    <header id="header">
      <div class="heading left">
        
        <a class="logo" href="/en/" title="">Emain Ablach</a>
        
        
        <a class="lang-op" href="/en/" title="">en</a>
        
        <a class="lang-op" href="/jp/" title="">jp</a>
        
        <a class="lang-op" href="/zh/" title="">zh</a>
        
      </div>
      <div class="right">
        <nav class="jumplist">
          <ul>
            
            
            <li>
              <a href="/en/oceanus/" title="">Oceanus</a>
            </li>
            
            <li>
              <a href="/en/whimsia/" title="">Whimsia</a>
            </li>
            
          </ul>
        </nav>
        <nav class="jumplist">
          <ul>
            
            
            <li>
              <a href="/en/about" title="">About</a>
            </li>
            
            <li>
              <a href="/en/dot-emacs" title="">init.el</a>
            </li>
            
          </ul>
        </nav>
      </div>
    </header>
    <main>
    
<article>
  <header>
    <h1>LeetCode 8: String to Integer (atoi)</h1>
    <div class="reading-info">
      <div class="left">
        <span>472 words</span>
        <span>
          &bull;
        </span>
        <span>3 min read</span>
      </div>
      <div class="right">
        <span><time>published at 11-06-2019</time></span>
        <span>
          &bull;
        </span>
        <span><time>last modified at 11-06-2019</time></span>
      </div>
    </div>
  </header>
  

<p>Started from today I&rsquo;ll post some short solutions / reports to some algorithm-ish problems. Today&rsquo;s one is
<a href="https://leetcode.com/problems/string-to-integer-atoi/">String to Integer (atoi)</a> from LeetCode. This one is fairly simple so I&rsquo;ll skip the algorithm analysis part. I choose this simple problem because it&rsquo;s a good opportunity to try Literate Programming beyond simple config maintenance. Having spending time figuring out how to make Org Mode  and Org Babel behave in the way I want, I don&rsquo;t feel like that I have enough time to solve a problem harder than simple string manipulation.</p>

<h2 id="full-program">Full program</h2>

<p><a id="code-snippet--myatoi"></a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#4c8317">#include</span> <span style="color:#4c8317">&lt;stdint.h&gt;</span><span style="color:#4c8317">
</span><span style="color:#4c8317"></span>
<span style="color:#0aa">int</span> <span style="color:#0a0">myAtoi</span>(<span style="color:#0aa">char</span> *str) {
    <span style="color:#00a">while</span> (*str == <span style="color:#a50">&#39; &#39;</span> &amp;&amp; *str != <span style="color:#a50">&#39;\0&#39;</span>) {
        str++;
    }
    <span style="color:#00a">if</span> (*str == <span style="color:#a50">&#39;\0&#39;</span>) {
        <span style="color:#00a">return</span> <span style="color:#099">0</span>;
    }
    <span style="color:#00a">if</span> ((*str &lt; <span style="color:#a50">&#39;0&#39;</span> || *str &gt; <span style="color:#a50">&#39;9&#39;</span>) &amp;&amp; (*str != <span style="color:#a50">&#39;+&#39;</span> &amp;&amp; *str !=<span style="color:#a50">&#39;-&#39;</span>)) {
        <span style="color:#00a">return</span> <span style="color:#099">0</span>;
    }

    int64_t sign = <span style="color:#099">1</span>;
    <span style="color:#00a">if</span> (*str == <span style="color:#a50">&#39;-&#39;</span>) {
        sign = -<span style="color:#099">1</span>;
        str++;
    } <span style="color:#00a">else</span> <span style="color:#00a">if</span> (*str == <span style="color:#a50">&#39;+&#39;</span>) {
        str++;
    }

    int64_t n = <span style="color:#099">0</span>;
    <span style="color:#00a">while</span> (*str &gt;= <span style="color:#a50">&#39;0&#39;</span> &amp;&amp; *str &lt;= <span style="color:#a50">&#39;9&#39;</span>) {
        int64_t digit = *str - <span style="color:#a50">&#39;0&#39;</span>;
        n = n * <span style="color:#099">10</span> + sign * digit;
        <span style="color:#00a">if</span> (n &gt;= INT32_MAX) {
            <span style="color:#00a">return</span> INT32_MAX;
        } <span style="color:#00a">else</span> <span style="color:#00a">if</span> (n &lt;= INT32_MIN) {
            <span style="color:#00a">return</span> INT32_MIN;
        }
        ++str;
    }
    <span style="color:#00a">return</span> n;
}</code></pre></div>
<h2 id="steps">Steps</h2>

<p>First, skip all space and immediately escape from some edge cases, including empty string and strings that begin with letters:</p>

<p><a id="code-snippet--myatoi-prefix"></a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#00a">while</span> (*str == <span style="color:#a50">&#39; &#39;</span> &amp;&amp; *str != <span style="color:#a50">&#39;\0&#39;</span>) {
    str++;
}
<span style="color:#00a">if</span> (*str == <span style="color:#a50">&#39;\0&#39;</span>) {
    <span style="color:#00a">return</span> <span style="color:#099">0</span>;
}
<span style="color:#00a">if</span> ((*str &lt; <span style="color:#a50">&#39;0&#39;</span> || *str &gt; <span style="color:#a50">&#39;9&#39;</span>) &amp;&amp; (*str != <span style="color:#a50">&#39;+&#39;</span> &amp;&amp; *str !=<span style="color:#a50">&#39;-&#39;</span>)) {
    <span style="color:#00a">return</span> <span style="color:#099">0</span>;
}</code></pre></div>
<p>Then, depend on what&rsquo;s coming next, set the sign value. Also do remember to skip sign symbols.</p>

<p><a id="code-snippet--myatoi-signhandle"></a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">int64_t sign = <span style="color:#099">1</span>;
<span style="color:#00a">if</span> (*str == <span style="color:#a50">&#39;-&#39;</span>) {
    sign = -<span style="color:#099">1</span>;
    str++;
} <span style="color:#00a">else</span> <span style="color:#00a">if</span> (*str == <span style="color:#a50">&#39;+&#39;</span>) {
    str++;
}</code></pre></div>
<p>Finally the main part, simply just use a 64 bit signed integer to save intermediate results. Technically 32 bit signed int is good enough to solve this problem, but Leetcode mark a testcase as failed if you use some overflow trick.</p>

<p><a id="code-snippet--myatoi-convert"></a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">int64_t n = <span style="color:#099">0</span>;
<span style="color:#00a">while</span> (*str &gt;= <span style="color:#a50">&#39;0&#39;</span> &amp;&amp; *str &lt;= <span style="color:#a50">&#39;9&#39;</span>) {
    int64_t digit = *str - <span style="color:#a50">&#39;0&#39;</span>;
    n = n * <span style="color:#099">10</span> + sign * digit;
    <span style="color:#00a">if</span> (n &gt;= INT32_MAX) {
        <span style="color:#00a">return</span> INT32_MAX;
    } <span style="color:#00a">else</span> <span style="color:#00a">if</span> (n &lt;= INT32_MIN) {
        <span style="color:#00a">return</span> INT32_MIN;
    }
    ++str;
}
<span style="color:#00a">return</span> n;</code></pre></div>
<h2 id="tests">tests</h2>

<p>Example testcase 1:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">printf(<span style="color:#a50">&#34;%d == %d&#34;</span>, myAtoi(<span style="color:#a50">&#34;42&#34;</span>), <span style="color:#099">42</span>);</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">42 == 42</code></pre></div>
<p>Example testcase 2:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">printf(<span style="color:#a50">&#34;%d == %d&#34;</span>, myAtoi(<span style="color:#a50">&#34;   -42&#34;</span>), -<span style="color:#099">42</span>);</code></pre></div>
<p>Example testcase 3:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">-42 == -42</code></pre></div>
<p>Example testcase 4:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">printf(<span style="color:#a50">&#34;%d == %d&#34;</span>, myAtoi(<span style="color:#a50">&#34;4193 with words&#34;</span>), <span style="color:#099">4193</span>);</code></pre></div>
<p>Example testcase 5:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">4193 == 4193</code></pre></div>
<p>Example testcase 6:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">printf(<span style="color:#a50">&#34;%d == %d&#34;</span>, myAtoi(<span style="color:#a50">&#34;words and 987&#34;</span>), <span style="color:#099">0</span>);</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">0 == 0</code></pre></div>
<p>Example testcase 7:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">printf(<span style="color:#a50">&#34;%d == %d&#34;</span>, myAtoi(<span style="color:#a50">&#34;-9128347233&#34;</span>), -<span style="color:#099">2147483648</span>);</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">-2147483648 == -2147483648</code></pre></div>
<p>Another edge case:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">printf(<span style="color:#a50">&#34;%d == %d&#34;</span>, myAtoi(<span style="color:#a50">&#34;2147483648&#34;</span>), <span style="color:#099">2147483647</span>);</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">2147483647 == 2147483647</code></pre></div>
  <footer class="reading-info">
    <div class="left">
       <div class="tags">
    &#x1f3f7;
    <nav class="jumplist">
        <ul>
          
    
    
    <li><a href="https://quinoa42.github.io/en/categories/algorithm/">algorithm</a></li>
    


          
    
    
    <li><a href="https://quinoa42.github.io/en/tags/c/">C</a></li>
    


        </ul>
    </nav>
</div>

    </div>
    <div class="right">
      <a href="https://quinoa42.github.io/en/oceanus/leetcode-8/">permalink to this post</a>
    </div>
  </footer>
</article>

    </main>
    <footer id="footer">
    
    <hr />
    <div><a href="https://github.com/quinoa42">GitHub</a></div>
    <div><a href="https://bgm.tv/user/112851">Bangumi</a></div>
    <div><a href="https://myanimelist.net/profile/quinoa42">MyAnimeList</a></div>
    
    </footer>
  </body>
</html>
