<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" />
    
    <link rel="stylesheet" href="https://quinoa42.github.io/style/site.min.css">
    <title>
  latex &ndash; Emain Ablach
</title>
  </head>
  <body>
    <header id="header">
      <div class="logo"><a href="https://quinoa42.github.io/">Emain Ablach</a></div>
      <nav class="jumplist">
        <ul>
          
          <li><a href="https://quinoa42.github.io/en/oceanus/">Oceanus</a></li>
          
          <li><a href="https://quinoa42.github.io/en/whimsia/">Whimsia</a></li>
          
        </ul>
      </nav>
    </header>
    <main>
    
  
      <article class="post-item">
        <header>
          <div class="tt">
            <h1><a href="/en/oceanus/vimtex-user-defined-completion/">Auto-complete user-defined LaTeX packages and classes with Vimtex</a></h1>
            <time>05-17-2019</time>
          </div>
          <div class="reading-info">
            <div class="left">
             <div class="tags">
    &#x1f3f7;
    <nav class="jumplist">
        <ul>
          
    
    
    <li><a href="https://quinoa42.github.io/en/categories/software/">software</a></li>
    


          
    
    
    <li><a href="https://quinoa42.github.io/en/tags/vim/">Vim</a></li>
    

    
    
    <li><a href="https://quinoa42.github.io/en/tags/latex/">latex</a></li>
    


        </ul>
    </nav>
</div>

            </div>
            <div class="right">
              <span>363 words</span>
              <span>
                &bull;
              </span>
              <span>2 min read</span>
            </div>
          </div>
        </header>
        

<p><a href="https://github.com/lervag/vimtex">vimtex</a> is one of the most commonly used LaTeX plugin (which is also what I use) in the vim community that supports auto-completion, conceal, synctex pdf preview, and many other modern features. In the last few months after I switched to Linux, the macros I defined in my LaTeX template has grown to such an extent that I have to move them into separate packages and classes. Doing so is <a href="https://en.wikibooks.org/wiki/LaTeX/Creating%5FPackages">quite easy</a>, but I got a problem: the commands in my own packages and classes are not in the candidate list of auto-completion!</p>

<h2 id="auto-complete-usepackage-and-documentclass">Auto-Complete <code>\usepackage</code> and <code>\documentclass</code></h2>

<p>This is fairly easy: put them into <code>$TEXMFHOME</code> with a directory structure like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">texmf
└── tex
   └── latex
      ├── mlaarticle
      │  └── mlaarticle.cls
      └── proofh
         └── proofh.sty</code></pre></div>
<p>Then it should work out of the box, otherwise try <code>sudo hashtex</code>.</p>

<h2 id="auto-complete-new-commands-and-environments">Auto-complete new commands and environments</h2>

<p>The problem is that commands and environments defined in these new packages are not in the candidate lists at all! It is easy to see from <a href="https://github.com/lervag/vimtex/tree/master/autoload/vimtex/complete">vimtex source code</a> that these completion candidates are mostly hard-coded. Thus, the only things we need to do is to create files corresponding to our packages in this given format, and put them inside <code>vimtex/autoload/vimtex/complete</code>.</p>

<p>The candidate file format is very straightforward: file is named <code>SOMEPACKAGE</code> if it is for a package of the same name, and <code>class-SOMECLASS</code> if it is for a class of the same name. In each file, candidates are separated by new lines, and to declare a command it will simply be its name, and to declare an environment it will be something like <code>\begin{ENV}</code>. After making this kind of files, the auto-completion works for our own packages!</p>

<h2 id="further-readings">Further Readings</h2>

<p>LaTeX is not only great at scientific and technical writing, but also a great way to do most things you do with Docs and PowerPoints, because it is easy to set up your own content-and-format-independent templates, which enable better concentration on the content itself. Here are many resources that worth reading:</p>

<ul>
<li><a href="https://en.wikibooks.org/wiki/LaTeX/Creating%5FPackages">LaTeX/Creating Packages</a> on Wikibooks</li>
<li><a href="https://castel.dev/post/lecture-notes-1/">How I&rsquo;m able to take notes in mathematics lectures using LaTeX and Vim</a> by Gilles Castel</li>
<li><a href="https://liam.page/2019/03/18/separation-of-content-and-presentation/">到底什么是「内容与样式分离」</a> by Liam Huang</li>
<li><a href="https://junyixu.github.io/2019/03/08/Happy-LaTeXing/">在 ArchLinux 上愉快地 LaTeXing</a> by Junix</li>
</ul>

      </article>
  

    </main>
    <footer id="footer">
    
    <hr />
    <div><a href="https://github.com/quinoa42">GitHub</a></div>
    <div><a href="https://bgm.tv/user/112851">Bangumi</a></div>
    <div><a href="https://myanimelist.net/profile/quinoa42">MyAnimeList</a></div>
    
    </footer>
  </body>
</html>
